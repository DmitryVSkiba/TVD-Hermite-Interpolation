%% LyX 2.1.0 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[russian]{article}
\usepackage[T2A,T1]{fontenc}
\usepackage[koi8-r]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
\DeclareRobustCommand{\cyrtext}{%
  \fontencoding{T2A}\selectfont\def\encodingdefault{T2A}}
\DeclareRobustCommand{\textcyr}[1]{\leavevmode{\cyrtext #1}}
\AtBeginDocument{\DeclareFontEncoding{T2A}{}{}}


\makeatother

\usepackage{babel}
\begin{document}

\section*{Алгоритм расчета полинмов Эрмита с обеспечением монотонности }

Данный алгоритм предлагается реализовать согласно работы Accurate
Monotonicity Preserving Cubic Interpolation, J. M. Hyman, Society
of Industrial and Applied Mathematics Journal of Scientific and Statistical
Computing, 4, No. 4, (December 1983) pp. 645-654.( метод Fritsch-Butland) 


\section{Исходные данные для алгоритма. }
\begin{itemize}
\item Одномерный массив точек в которых интерполируется функция (в данном
случае $T_{i}$) длиной N штук, нумерация начинается с 0, индекс последнего
элемента массива N-1 
\item Одномерный массив значений функции в точках в данном случае массив
значений открытия крана в \% ($Y_{i}$) длиной N штук, нумерация начинается
с 0, индекс последнего элемента массива N-1 
\end{itemize}

\section{Подготовительные операции.}

Рассчитываются следующие массивы $h_{i}$,$\varDelta_{i}$ длины N-1,
нумерация начинается с 0, последний элемент массива имеет индекс N-2
:

\[
h_{i}:=T_{i+1}-T_{i};\thinspace\thinspace\thinspace\thinspace\varDelta_{i}=\frac{\left(Y_{i+1}-Y_{i}\right)}{h_{i}}
\]
.

Расчитываются дополнительные массивы значений для шагов по независимой
переменной $\left(w_{1_{i}},w_{2_{i}},H_{i}\right)$длины N-2, нумерация
начинается с 0, последний элемент массива имеет индекс N-3: 

\[
H_{i}:=\left(h_{i}+h_{i+1}\right);\thinspace\thinspace\thinspace\thinspace w_{1_{i}}:=\frac{\left(h_{i}+H_{i}\right)}{3H_{i}};\thinspace\thinspace\thinspace\thinspace w_{2_{i}}:=\frac{\left(h_{i+1}+H_{i}\right)}{3H_{i}}
\]
.


\section{Процедура ограничения производных для обеспечения монотонности. }

По данным подготовительной операции находятся массивы $d_{max_{i}}$и
$d_{min_{i}}$ , нумерация начинается с 0, длины N-2, последний элемент
массива имеет индекс N-3 по следующим формулам: 

\[
d_{max_{i}}:=max\left(\left|\varDelta_{i}\right|,\left|\varDelta_{i+1}\right|\right)
\]


\[
d_{min_{i}}:=min\left(\left|\varDelta_{i}\right|,\left|\varDelta_{i+1}\right|\right)
\]


По данным этих массивов строится массив $A_{i}$, нумерация начинается
с 0, длины N-2, последний элемент массива имеет индекс N-3 по формуле:

\[
A_{i}:=\frac{d_{min_{i}}d_{max_{i}}}{w_{1_{i}}\Delta_{i}+w_{2_{i}}\Delta_{i+1}}
\]


По результатам расчета данных масивов считается массив $d_{i}$, нумерация
начинается с 0, длины N-2, последний элемент массива имеет индекс
N-3

\[
d_{i}:=\begin{cases}
A_{i} & \text{если }\varDelta_{\text{i}}\varDelta_{i+1}>0\\
0 & \text{иначе}
\end{cases}
\]



\section{Расчет коэффициентов кусочно кубического сплайна Эрмита}

Расчитывается массив коэффициентов кубического сплайна $D_{i}$ нумерация
начинается с 0, длины N, последний элемент массива имеет индекс N-1

в диапазоне индексов i=1..N-2 $D_{i}$расчитываются по формуле:
\[
D_{i}:=d_{i-1},
\]


$D_{0}$расчитывается по формуле

\[
D_{0}:=\begin{cases}
\frac{\left(\left(2h_{0}+h_{1}\right)\varDelta_{0}-h_{0}\varDelta_{1}\right)}{h_{0}+h_{1}} & \text{если }\frac{\left(\left(2h_{0}+h_{1}\right)\varDelta_{0}-h_{0}\varDelta_{1}\right)}{h_{0}+h_{1}}\varDelta_{0}>0\\
0 & \text{иначе}
\end{cases},
\]


а $D_{N-1}$расчитывается по формуле 
\[
D_{N-1}:=\begin{cases}
\frac{\left(\left(2h_{N-2}+h_{N-3}\right)\varDelta_{N-2}-h_{N-2}\varDelta_{N-3}\right)}{h_{N-2}+h_{N-3}} & \text{если }\frac{\left(\left(2h_{N-2}+h_{N-3}\right)\varDelta_{N-2}-h_{N-2}\varDelta_{N-3}\right)}{h_{N-2}+h_{N-3}}\varDelta_{N-2}>0\\
0 & \text{иначе}
\end{cases}.
\]


Расчитываются окончательные коэффициенты кусочно кубического сплайна
$\Pi_{1_{\text{i}}}$,$\Pi_{2_{\text{i}}}$нумерация начинается с
0, длины $N-1$, индекс последнего элемента массива $N-2$ по следующим
формулам:

\[
\Pi_{1_{i}}:=\frac{\left(\Delta_{i}-D_{i}\right)}{h_{i}},
\]


\[
\Pi_{2_{\text{i}}}:=\frac{\left(D_{i+1}-\varDelta_{i}\right)}{h_{i}}.
\]



\section{Интерполяция значений по коэффициентам}

Пусть необходимо найти значение функции при значении независимой переменной
t

Если $t<T_{0}$то выдается значение $Y_{0}$,

Если $t>T_{N-1}$то выдается значение $Y_{N-1}$

В противном случае находится такой индекс массива $j$ что выполняются
следующие условия:$\left(T_{j}<t\right)$и $\left(t>T_{j+1}\right)$

Тогда вычисляется $\theta$ относительное значение переменной $t$
по формуле:

\[
\theta=t-T_{j}.
\]


тогда выдается значение $y$ вычисляемое по формуле 
\[
y:=T_{j}+\theta\cdot\left(D_{j}+\theta\cdot\left(2\Pi_{1_{j}}-\Pi_{2_{\text{j}}}+\theta\cdot\left(\left(\Pi_{2_{j}}-\Pi_{1_{j}}\right)/h_{j}\right)\right)\right).
\]



\section{Тестовый пример и значения}

Заданные точки 

\[
T:=\left[0,0.25,0.35,0.5,0.8,1\right];\thinspace\thinspace Y:=\left[0,0.25,0.4,0.7,1,1\right]
\]


\includegraphics{plot1}

Результаты расчета коэффициентов полиномов Эрмита

\[
D:=\left[0.642857,1.16667,1.73077,1.28571,0,0\right]
\]
\[
\Pi_{1}=\left[1.42857,3.33333,1.79487,-0.952381,0.\right]
\]


\[
\Pi_{2}=\left[0.666667,2.30769,-4.7619,-3.33333,0.\right]
\]

\end{document}
